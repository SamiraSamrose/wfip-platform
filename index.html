<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WFIP - Web Feature Intelligence Platform</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .feature-card {
            transition: all 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .modal.active {
            display: flex;
        }
        .scan-animation {
            width: 100%;
            height: 4px;
            background: #667eea;
            animation: scan 2s ease-in-out;
        }
        @keyframes scan {
            0% { width: 0%; }
            100% { width: 100%; }
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Header -->
    <header class="gradient-bg shadow-2xl">
        <div class="container mx-auto px-6 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="bg-white/20 p-3 rounded-xl backdrop-blur-sm">
                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold">WFIP Dashboard</h1>
                        <p class="text-sm text-white/80">Web Feature Intelligence Platform</p>
                    </div>
                </div>
                <button onclick="runNewScan()" class="bg-white/20 hover:bg-white/30 px-6 py-3 rounded-lg font-semibold transition-all backdrop-blur-sm">
                    <span class="flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        New Scan
                    </span>
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <div class="container mx-auto px-6 py-6">
        <div class="flex gap-2 bg-gray-800/50 p-1 rounded-xl backdrop-blur-sm inline-flex">
            <button onclick="switchTab('overview')" id="tab-overview" class="tab-btn px-6 py-3 rounded-lg transition-all font-medium bg-blue-600 text-white">
                Overview
            </button>
            <button onclick="switchTab('features')" id="tab-features" class="tab-btn px-6 py-3 rounded-lg transition-all font-medium text-gray-400">
                Features
            </button>
            <button onclick="switchTab('heatmap')" id="tab-heatmap" class="tab-btn px-6 py-3 rounded-lg transition-all font-medium text-gray-400">
                Heatmap
            </button>
            <button onclick="switchTab('history')" id="tab-history" class="tab-btn px-6 py-3 rounded-lg transition-all font-medium text-gray-400">
                History
            </button>
        </div>
    </div>

    <div class="container mx-auto px-6 pb-12">
        <!-- Overview Tab -->
        <div id="content-overview" class="tab-content">
            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700 hover:border-green-500/50 transition-all">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-gray-400 text-sm">Avg Compliance</p>
                            <h3 class="text-4xl font-bold mt-2" id="avg-compliance">87.3%</h3>
                        </div>
                        <div class="bg-green-500/20 p-4 rounded-xl">
                            <svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 text-sm text-green-400">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                        </svg>
                        <span>+2.3% from last week</span>
                    </div>
                </div>

                <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700 hover:border-blue-500/50 transition-all">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-gray-400 text-sm">UIs Tracked</p>
                            <h3 class="text-4xl font-bold mt-2" id="uis-tracked">12</h3>
                        </div>
                        <div class="bg-blue-500/20 p-4 rounded-xl">
                            <svg class="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                    <p class="text-sm text-gray-400">3 with high-risk features</p>
                </div>

                <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700 hover:border-purple-500/50 transition-all">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-gray-400 text-sm">Features Scanned</p>
                            <h3 class="text-4xl font-bold mt-2" id="features-count">47</h3>
                        </div>
                        <div class="bg-purple-500/20 p-4 rounded-xl">
                            <svg class="w-8 h-8 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"></path>
                            </svg>
                        </div>
                    </div>
                    <p class="text-sm text-gray-400">8 newly available</p>
                </div>

                <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700 hover:border-red-500/50 transition-all">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-gray-400 text-sm">High Risk</p>
                            <h3 class="text-4xl font-bold mt-2 text-red-400" id="high-risk-count">5</h3>
                        </div>
                        <div class="bg-red-500/20 p-4 rounded-xl">
                            <svg class="w-8 h-8 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                            </svg>
                        </div>
                    </div>
                    <p class="text-sm text-gray-400">Immediate attention needed</p>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700">
                    <h3 class="text-xl font-semibold mb-6">Feature Risk Distribution</h3>
                    <div class="relative" style="height: 300px;">
                        <canvas id="riskChart"></canvas>
                    </div>
                </div>

                <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700">
                    <h3 class="text-xl font-semibold mb-6">Compliance Trend (Last 30 Days)</h3>
                    <div class="relative" style="height: 300px;">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700">
                <h3 class="text-xl font-semibold mb-6">UI Compliance Comparison</h3>
                <div class="relative" style="height: 350px;">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Features Tab -->
        <div id="content-features" class="tab-content hidden">
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-4 border border-gray-700 mb-6">
                <div class="relative">
                    <svg class="absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    <input type="text" id="feature-search" placeholder="Search features..." class="w-full pl-12 pr-4 py-3 bg-gray-700/50 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-white" oninput="filterFeatures()">
                </div>
            </div>

            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl border border-gray-700 overflow-hidden">
                <table class="w-full">
                    <thead class="bg-gray-700/50">
                        <tr>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">Feature</th>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">Global Support</th>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">Risk Level</th>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">Status</th>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="features-tbody" class="divide-y divide-gray-700"></tbody>
                </table>
            </div>
        </div>

        <!-- Heatmap Tab -->
        <div id="content-heatmap" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="heatmap-grid"></div>
        </div>

        <!-- History Tab -->
        <div id="content-history" class="tab-content hidden">
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl border border-gray-700 overflow-hidden">
                <table class="w-full">
                    <thead class="bg-gray-700/50">
                        <tr>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">UI Name</th>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">Scan Date</th>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">Compliance</th>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">Features</th>
                            <th class="text-left px-6 py-4 font-semibold text-gray-300">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="history-tbody" class="divide-y divide-gray-700"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Feature Detail Modal -->
    <div id="feature-modal" class="modal">
        <div class="bg-gray-800 rounded-2xl max-w-2xl w-full mx-4 p-8 border border-gray-700">
            <div class="flex items-start justify-between mb-6">
                <div>
                    <div class="text-3xl font-bold text-blue-400" id="modal-feature-name"></div>
                    <p class="text-gray-400 mt-2">Feature Risk Assessment</p>
                </div>
                <button onclick="closeModal()" class="text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-gray-700/50 rounded-xl p-4">
                    <p class="text-gray-400 text-sm mb-1">Global Support</p>
                    <p class="text-3xl font-bold text-green-400" id="modal-support"></p>
                </div>
                <div class="bg-gray-700/50 rounded-xl p-4">
                    <p class="text-gray-400 text-sm mb-1">Risk Level</p>
                    <p class="text-3xl font-bold" id="modal-risk"></p>
                </div>
            </div>

            <div class="space-y-4 mb-6">
                <div>
                    <p class="text-gray-400 text-sm mb-2">Baseline Status</p>
                    <span class="px-3 py-1 rounded-full text-sm font-medium" id="modal-status"></span>
                </div>

                <div>
                    <p class="text-gray-400 text-sm mb-2">Browser Support</p>
                    <div class="grid grid-cols-2 gap-2" id="modal-browsers"></div>
                </div>

                <div>
                    <p class="text-gray-400 text-sm mb-2">Recommendation</p>
                    <div class="bg-blue-500/10 border border-blue-500/30 rounded-lg p-4">
                        <p class="text-blue-300" id="modal-recommendation"></p>
                    </div>
                </div>

                <div id="modal-alternatives-section" class="hidden">
                    <p class="text-gray-400 text-sm mb-2">Alternatives</p>
                    <div class="flex flex-wrap gap-2" id="modal-alternatives"></div>
                </div>
            </div>

            <div class="flex gap-3">
                <button class="flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors font-medium">
                    View Documentation
                </button>
                <button class="flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors font-medium">
                    Check Alternatives
                </button>
            </div>
        </div>
    </div>

    <!-- Scan Modal -->
    <div id="scan-modal" class="modal">
        <div class="bg-gray-800 rounded-2xl max-w-md w-full mx-4 p-8 border border-gray-700">
            <h3 class="text-2xl font-bold mb-6">New Scan</h3>
            
            <div class="space-y-4 mb-6">
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Scan Type</label>
                    <select class="w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-lg text-white">
                        <option>Directory Scan</option>
                        <option>URL Crawl</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Path or URL</label>
                    <input type="text" placeholder="./src or https://example.com" class="w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-lg text-white">
                </div>
                
                <div>
                    <label class="block text-sm text-gray-400 mb-2">UI Name</label>
                    <input type="text" placeholder="Dashboard UI" class="w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-lg text-white">
                </div>
            </div>

            <div id="scan-progress" class="hidden mb-6">
                <p class="text-sm text-gray-400 mb-2">Scanning...</p>
                <div class="w-full h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="scan-animation bg-blue-500 h-full"></div>
                </div>
            </div>

            <div class="flex gap-3">
                <button onclick="startScan()" class="flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors font-medium">
                    Start Scan
                </button>
                <button onclick="closeScanModal()" class="flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors font-medium">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        const mockFeatures = [
            { name: ':has()', support: 87.3, risk: 4.2, status: 'newly_available', browsers: { chrome: '105+', safari: '15.4+', firefox: '121+' }, alternatives: [':not() combinations', 'JS selectors'] },
            { name: 'backdrop-filter', support: 94.5, risk: 1.8, status: 'widely_available', browsers: { chrome: '76+', safari: '9+', firefox: '103+' }, alternatives: [] },
            { name: 'subgrid', support: 72.4, risk: 7.5, status: 'limited', browsers: { chrome: '117+', safari: '16+', firefox: '71+' }, alternatives: ['nested grids', 'flexbox'] },
            { name: 'container-queries', support: 85.1, risk: 5.0, status: 'newly_available', browsers: { chrome: '105+', safari: '16+', firefox: '110+' }, alternatives: ['media queries', 'ResizeObserver'] },
            { name: 'view-transitions', support: 68.2, risk: 8.3, status: 'limited', browsers: { chrome: '111+', safari: 'No', firefox: 'No' }, alternatives: ['CSS transitions', 'FLIP technique'] },
            { name: 'scroll-snap', support: 96.2, risk: 1.2, status: 'widely_available', browsers: { chrome: '69+', safari: '11+', firefox: '68+' }, alternatives: [] },
            { name: 'IntersectionObserver', support: 96.8, risk: 1.0, status: 'widely_available', browsers: { chrome: '51+', safari: '12.1+', firefox: '55+' }, alternatives: [] },
            { name: '@layer', support: 89.5, risk: 3.5, status: 'newly_available', browsers: { chrome: '99+', safari: '15.4+', firefox: '97+' }, alternatives: [] }
        ];

        const mockHistory = [
            { ui: 'Dashboard UI', date: '2025-09-28', compliance: 87.5, features: 12 },
            { ui: 'Admin Panel', date: '2025-09-27', compliance: 72.3, features: 18 },
            { ui: 'Marketing Site', date: '2025-09-26', compliance: 94.2, features: 8 },
            { ui: 'Mobile App', date: '2025-09-25', compliance: 81.7, features: 15 },
            { ui: 'Dashboard UI', date: '2025-09-20', compliance: 85.1, features: 12 },
            { ui: 'Admin Panel', date: '2025-09-18', compliance: 69.8, features: 18 }
        ];

        const mockHeatmap = [
            { ui: 'Dashboard UI', compliance: 87.5, total: 12, highRisk: ['subgrid'], deprecated: [] },
            { ui: 'Admin Panel', compliance: 72.3, total: 18, highRisk: ['subgrid', 'view-transitions'], deprecated: ['document.write'] },
            { ui: 'Marketing Site', compliance: 94.2, total: 8, highRisk: [], deprecated: [] },
            { ui: 'Mobile App', compliance: 81.7, total: 15, highRisk: [':has()'], deprecated: [] },
            { ui: 'Analytics Dashboard', compliance: 89.3, total: 10, highRisk: [], deprecated: [] },
            { ui: 'Settings UI', compliance: 76.5, total: 14, highRisk: ['container-queries'], deprecated: [] }
        ];

        let charts = {};

        function init() {
            initCharts();
            populateFeatures();
            populateHistory();
            populateHeatmap();
        }

        function initCharts() {
            const riskCtx = document.getElementById('riskChart').getContext('2d');
            charts.risk = new Chart(riskCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Low Risk', 'Medium Risk', 'High Risk'],
                    datasets: [{
                        data: [3, 3, 2],
                        backgroundColor: ['#10b981', '#f59e0b', '#ef4444'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#9ca3af', font: { size: 12 } }
                        }
                    }
                }
            });

            const trendCtx = document.getElementById('trendChart').getContext('2d');
            charts.trend = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['Sep 20', 'Sep 22', 'Sep 25', 'Sep 26', 'Sep 27', 'Sep 28'],
                    datasets: [{
                        label: 'Compliance Score',
                        data: [85.1, 86.2, 81.7, 94.2, 72.3, 87.5],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 60,
                            max: 100,
                            ticks: { color: '#9ca3af' },
                            grid: { color: '#374151' }
                        },
                        x: {
                            ticks: { color: '#9ca3af' },
                            grid: { display: false }
                        }
                    }
                }
            });

            const compCtx = document.getElementById('comparisonChart').getContext('2d');
            charts.comparison = new Chart(compCtx, {
                type: 'bar',
                data: {
                    labels: ['Dashboard', 'Admin', 'Marketing', 'Mobile'],
                    datasets: [
                        {
                            label: 'Compliance %',
                            data: [87.5, 72.3, 94.2, 81.7],
                            backgroundColor: '#10b981'
                        },
                        {
                            label: 'High Risk Features',
                            data: [1, 2, 0, 1],
                            backgroundColor: '#ef4444'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#9ca3af', font: { size: 12 } }
                        }
                    },
                    scales: {
                        y: { ticks: { color: '#9ca3af' }, grid: { color: '#374151' } },
                        x: { ticks: { color: '#9ca3af' }, grid: { display: false } }
                    }
                }
            });
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById('content-' + tab).classList.remove('hidden');
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white', 'shadow-lg');
                btn.classList.add('text-gray-400');
            });
            
            document.getElementById('tab-' + tab).classList.add('bg-blue-600', 'text-white', 'shadow-lg');
            document.getElementById('tab-' + tab).classList.remove('text-gray-400');
        }

        function populateFeatures() {
            const tbody = document.getElementById('features-tbody');
            tbody.innerHTML = '';
            
            mockFeatures.forEach(feature => {
                const row = document.createElement('tr');
                row.classList.add('hover:bg-gray-700/30', 'transition-colors');
                row.setAttribute('data-feature', feature.name.toLowerCase());
                
                const riskColor = feature.risk < 3 ? 'text-green-400' : feature.risk < 6 ? 'text-yellow-400' : 'text-red-400';
                const statusBg = feature.status === 'widely_available' ? 'bg-green-500/20 text-green-400' : 
                                 feature.status === 'newly_available' ? 'bg-yellow-500/20 text-yellow-400' : 
                                 'bg-red-500/20 text-red-400';
                
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <code class="text-blue-400 bg-blue-500/10 px-2 py-1 rounded">${feature.name}</code>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center gap-3">
                            <div class="w-32 bg-gray-700 rounded-full h-2">
                                <div class="bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all" style="width: ${feature.support}%"></div>
                            </div>
                            <span class="text-sm font-medium">${feature.support}%</span>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center gap-2">
                            <div class="w-2 h-2 rounded-full ${riskColor.replace('text-', 'bg-')}"></div>
                            <span class="text-sm ${riskColor}">${feature.risk.toFixed(1)}/10</span>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="px-3 py-1 rounded-full text-xs font-medium ${statusBg}">
                            ${feature.status.replace('_', ' ')}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <button onclick='showFeatureModal(${JSON.stringify(feature)})' class="text-blue-400 hover:text-blue-300 text-sm font-medium">
                            View Details
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function filterFeatures() {
            const search = document.getElementById('feature-search').value.toLowerCase();
            document.querySelectorAll('#features-tbody tr').forEach(row => {
                const featureName = row.getAttribute('data-feature');
                row.style.display = featureName.includes(search) ? '' : 'none';
            });
        }

        function populateHistory() {
            const tbody = document.getElementById('history-tbody');
            tbody.innerHTML = '';
            
            mockHistory.forEach(scan => {
                const row = document.createElement('tr');
                row.classList.add('hover:bg-gray-700/30', 'transition-colors');
                
                const complianceColor = scan.compliance >= 90 ? 'text-green-400' : 
                                       scan.compliance >= 70 ? 'text-yellow-400' : 
                                       'text-red-400';
                
                row.innerHTML = `
                    <td class="px-6 py-4 font-medium">${scan.ui}</td>
                    <td class="px-6 py-4 text-gray-400">${scan.date}</td>
                    <td class="px-6 py-4">
                        <span class="font-semibold ${complianceColor}">${scan.compliance}%</span>
                    </td>
                    <td class="px-6 py-4 text-gray-400">${scan.features}</td>
                    <td class="px-6 py-4">
                        <button class="text-blue-400 hover:text-blue-300 text-sm font-medium" onclick="alert('Full report for ${scan.ui}: ${scan.compliance}% compliance with ${scan.features} features detected')">
                            View Report
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function populateHeatmap() {
            const grid = document.getElementById('heatmap-grid');
            grid.innerHTML = '';
            
            mockHeatmap.forEach(ui => {
                const card = document.createElement('div');
                const borderColor = ui.compliance >= 90 ? 'border-green-500/50' : 
                                   ui.compliance >= 70 ? 'border-yellow-500/50' : 
                                   'border-red-500/50';
                const scoreColor = ui.compliance >= 90 ? 'text-green-400' : 
                                  ui.compliance >= 70 ? 'text-yellow-400' : 
                                  'text-red-400';
                
                card.className = `bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border ${borderColor} feature-card`;
                
                card.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-semibold text-lg">${ui.ui}</h3>
                        <div class="text-3xl font-bold ${scoreColor}">${ui.compliance}%</div>
                    </div>
                    
                    <div class="space-y-3 mb-4">
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-400">Total Features</span>
                            <span class="font-medium">${ui.total}</span>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-400">High Risk</span>
                            <span class="font-medium text-red-400">${ui.highRisk.length}</span>
                        </div>
                        ${ui.deprecated.length > 0 ? `
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-400">Deprecated</span>
                            <span class="font-medium text-orange-400">${ui.deprecated.length}</span>
                        </div>
                        ` : ''}
                    </div>
                    
                    ${ui.highRisk.length > 0 ? `
                    <div class="pt-4 border-t border-gray-700">
                        <p class="text-xs text-gray-400 mb-2">High Risk Features:</p>
                        <div class="flex flex-wrap gap-1">
                            ${ui.highRisk.map(f => `<code class="text-xs bg-red-500/10 text-red-400 px-2 py-1 rounded">${f}</code>`).join('')}
                        </div>
                    </div>
                    ` : '<div class="pt-4 border-t border-gray-700 text-sm text-green-400">✨ No high-risk features!</div>'}
                `;
                
                grid.appendChild(card);
            });
        }

        function showFeatureModal(feature) {
            const modal = document.getElementById('feature-modal');
            
            document.getElementById('modal-feature-name').textContent = feature.name;
            document.getElementById('modal-support').textContent = feature.support + '%';
            
            const riskColor = feature.risk < 3 ? 'text-green-400' : feature.risk < 6 ? 'text-yellow-400' : 'text-red-400';
            const riskEl = document.getElementById('modal-risk');
            riskEl.textContent = feature.risk.toFixed(1) + '/10';
            riskEl.className = `text-3xl font-bold ${riskColor}`;
            
            const statusBg = feature.status === 'widely_available' ? 'bg-green-500/20 text-green-400' : 
                            feature.status === 'newly_available' ? 'bg-yellow-500/20 text-yellow-400' : 
                            'bg-red-500/20 text-red-400';
            const statusEl = document.getElementById('modal-status');
            statusEl.textContent = feature.status.replace('_', ' ');
            statusEl.className = `px-3 py-1 rounded-full text-sm font-medium ${statusBg}`;
            
            const browsersEl = document.getElementById('modal-browsers');
            browsersEl.innerHTML = Object.entries(feature.browsers).map(([browser, version]) => `
                <div class="flex items-center gap-2 bg-gray-700/50 px-3 py-2 rounded-lg">
                    <span class="text-sm font-medium capitalize">${browser}</span>
                    <span class="text-xs text-gray-400">${version}</span>
                </div>
            `).join('');
            
            const recommendation = feature.risk < 3 ? 
                '✅ Safe to use. This feature has excellent browser support.' :
                feature.risk < 6 ?
                '⚠️ Use with caution. Consider progressive enhancement or polyfills for older browsers.' :
                '🔥 High risk. Strongly consider alternatives or ensure fallbacks are in place.';
            document.getElementById('modal-recommendation').textContent = recommendation;
            
            const altSection = document.getElementById('modal-alternatives-section');
            if (feature.alternatives && feature.alternatives.length > 0) {
                altSection.classList.remove('hidden');
                document.getElementById('modal-alternatives').innerHTML = feature.alternatives.map(alt => 
                    `<span class="px-3 py-1 bg-gray-700/50 rounded-lg text-sm">${alt}</span>`
                ).join('');
            } else {
                altSection.classList.add('hidden');
            }
            
            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('feature-modal').classList.remove('active');
        }

        function runNewScan() {
            document.getElementById('scan-modal').classList.add('active');
        }

        function closeScanModal() {
            document.getElementById('scan-modal').classList.remove('active');
            document.getElementById('scan-progress').classList.add('hidden');
        }

        function startScan() {
            const progress = document.getElementById('scan-progress');
            progress.classList.remove('hidden');
            
            setTimeout(() => {
                closeScanModal();
                
                const results = {
                    compliance: Math.floor(Math.random() * 20) + 75,
                    features: Math.floor(Math.random() * 10) + 5,
                    highRisk: Math.floor(Math.random() * 3)
                };
                
                const notification = document.createElement('div');
                notification.className = 'fixed top-6 right-6 bg-green-500 text-white px-6 py-4 rounded-xl shadow-2xl z-50 flex items-center gap-3';
                notification.innerHTML = `
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="font-semibold">Scan Complete!</p>
                        <p class="text-sm">Compliance: ${results.compliance}% | Features: ${results.features}</p>
                    </div>
                `;
                document.body.appendChild(notification);
                
                setTimeout(() => notification.remove(), 4000);
                
                document.getElementById('avg-compliance').textContent = results.compliance + '%';
                document.getElementById('features-count').textContent = results.features;
                document.getElementById('high-risk-count').textContent = results.highRisk;
            }, 2000);
        }

        window.addEventListener('DOMContentLoaded', init);

        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                closeModal();
                closeScanModal();
            }
        });
    </script>
</body>
</html>
